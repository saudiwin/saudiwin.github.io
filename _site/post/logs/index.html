<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Robert Kubinec">
<meta name="dcterms.date" content="2022-12-15">
<meta name="description" content="Ordered beta regression can give you comparable, scale-free ATEs that can still be understood in the scale of the original data–all without using logs.">

<title>What’s Logs Got to Do With It? – Robert Kubinec</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="../../site_libs/quarto-contrib/iconify-2.1.0/iconify-icon.min.js"></script>
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-BHP1PJ9LEX"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-BHP1PJ9LEX', { 'anonymize_ip': true});
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Robert Kubinec</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/saudiwin"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://bsky.app/profile/rmkubinec.bsky.social"> 
<span class="menu-text"><iconify-icon role="img" inline="" icon="simple-icons:bluesky" aria-label="Icon bluesky from simple-icons Iconify.design set." title="Icon bluesky from simple-icons Iconify.design set."></iconify-icon></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../../files/Robert_Kubinec_CV_full.pdf" aria-current="page"> 
<span class="menu-text">CV</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">What’s Logs Got to Do With It?</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
  <div id="quarto-announcement" data-announcement-id="49c5ceee25639e4ac43a8a1663a84566" class="alert alert-dark hidden"><i class="bi bi-info-circle quarto-announcement-icon"></i><div class="quarto-announcement-content">
<p>My novel <em>The Bayesian Hitman</em> is now available on <a href="https://www.amazon.com/Bayesian-Hitman-Robert-M-Kubinec/dp/B0D6M4WNRZ/ref=tmm_pap_swatch_0?_encoding=UTF8&amp;qid=&amp;sr=">Amazon</a>.</p>
</div><i class="bi bi-x-lg quarto-announcement-action"></i></div>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">What’s Logs Got to Do With It?</h1>
            <p class="subtitle lead">Ordered beta regression can give you comparable, scale-free ATEs that can still be understood in the scale of the original data–all without using logs.</p>
                  <div>
        <div class="description">
          Ordered beta regression can give you comparable, scale-free ATEs that can still be understood in the scale of the original data–all without using logs.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">R</div>
                <div class="quarto-category">Elections</div>
                <div class="quarto-category">Beta Regression</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Robert Kubinec </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">December 15, 2022</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Punk Rock Poli Sci</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../files/Robert_Kubinec_CV_full.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CV</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../research/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Research</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../consulting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Consulting</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ordbetareg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ordered Beta Regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://saudiwin.github.io/idealstan/" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><code>idealstan</code></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p>Twitter (or what’s left of it) was recently ablaze with a discussion of two smart working papers, one by <a href="https://www.jonathandroth.com/assets/files/LogUniqueHOD0_Draft.pdf">Jiafeng Chen and Jonathan Roth</a> and the other by <a href="https://www.nber.org/system/files/working_papers/w30735/w30735.pdf">John Mullahy and Edward Norton</a>. In different ways, they argue against the use of non-linear transformations in applied modeling, especially logarithms (logs). I had been meaning to discuss the subject myself; I’ve been critical of the logarithmic transformation previously because it has been difficult to put a clear meaning on the transformation in a linear model. Furthermore, the inability of logs to include 0 (log of 0 is undefined or negative infinity, whichever is smaller) was a warning flag that there was a mismatch between what people wanted the math to do, and what it actually did.</p>
<p>What I’m going to show in this post is that the <a href="https://www.cambridge.org/core/journals/political-analysis/article/ordered-beta-regression-a-parsimonious-wellfitting-model-for-continuous-data-with-lower-and-upper-bounds/89F4141DA16D4FC217809B5EB45EEE83">ordered beta regression model</a> can also address issues with logs (and the related inverse hyperbolic sine transformation) because it can produce estimates (including ATEs) that are based on proportions, and thus naturally scale-free. When the scale of the outcome is an issue, the ordered beta regression can help address that problem by estimating regression coefficients or treatment effects that do not vary with scale and also include 0s.</p>
<p>The two papers presented above approach the log issue in different ways, which makes them both fascinating when read together. Mullahy and Norton take a more traditional econometric approach, discussing how the log and hyperbolic sine transformations are heavily influenced by the constant chosen to either “bump” zeros to 1s for the log or to scale the hyperbolic sine. Chen and Roth use different notation to discuss how the logarithmic transformation affects estimation of an average treatment effect (ATE) using the potential outcomes framework in the causal inference literature.</p>
<p>Both sets of authors point out that these transformations end up changing either linear regression coefficients or estimated ATEs in ways that are not immediately obvious. Using economic theory, Mullahy and Norton discuss how adding 1 to any zero value in a model in order to use logs results in the model weighting estimates by the proportion of 0s and non-0 values in the data, or what they call the “intensive” and “extensive” margin. The regression coefficient will vary depending on whether 0s are replaced by 1, 0.9, 0.8, 0.7… etc. There simply isn’t one good value that can be added to the data to allow a logarithm to be well-defined.</p>
<p>Chen and Roth make the point that the estimate of an ATE can vary with different scaling functions such as logarithms. As they put it,</p>
<blockquote class="blockquote">
<p>Our results above show that ATEs for common transformations such as <span class="math inline">\(log(1 + Y)\)</span> and <span class="math inline">\(arcsinh(Y)\)</span> can not be interpreted as percentage effects, given that their magnitudes depend arbitrarily on the units of the outcome.</p>
</blockquote>
<p>In other words, once you transform the outcome using one of these functions, we no longer know for sure that we will get the same ATE if we change the units, i.e.&nbsp;from dollars to cents, when using one of these common transformations. Chen and Roth’s suggestion, which is similar as well to Mullahy and Norton, is to consider using models that incorporate 0s (two-part models, also known as hurdles/zero-inflated models) or simple GLMs like the Poisson regression, which has had an amazing resurgence on <a href="https://twitter.com/jmwooldridge/status/1363828456136523779">Twitter at the moment</a>. (No idea, though, if Poisson’s momentum will last through the 2024 election.)</p>
<section id="simulation" class="level2">
<h2 class="anchored" data-anchor-id="simulation">Simulation</h2>
<p>I next use simulations to discuss this issue to show practically what the authors are talking about and also demonstrate how <code>ordbetareg</code> can estimate scale-free ATEs.</p>
<p>I simulate data that matches what the articles discuss: highly skewed outcomes with zeroes. To do so I’ll simulate a two-part or hurdle model in which the ATE influences the first part (the probability of a 0) and the second part (a conventional log-normal distribution strictly greater than 0). The ATE will influence both the probability of 0s, which at baseline is 10% of total observations, and the mean of the non-0 (log-normal) distribution. I will assume a true ATE of +1 on the log/logit scale. I can then simulate the potential outcomes, Y1 and Y0, as independent distributions with a difference of the ATE.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>ate <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>Y0 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">runif</span>(N)<span class="sc">&lt;</span><span class="fl">0.9</span>,<span class="fu">rlnorm</span>(N),<span class="dv">0</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>Y1 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">runif</span>(N)<span class="sc">&lt;</span><span class="fu">plogis</span>(<span class="fu">qlogis</span>(<span class="fl">0.9</span>) <span class="sc">+</span> ate),</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>             <span class="fu">rlnorm</span>(N,<span class="at">meanlog=</span>ate),</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>             <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can take a quick glance at the distributions:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Y1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/hist-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Y0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/hist-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The proportion of zeroes in Y0 is 0.086 and the proportion of zeroes in Y1 is 0.034.</p>
<p>We can then do some conventional comparisons of the treatment and control group, a t-test and linear model fit:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(Y1,Y0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  Y1 and Y0
t = 11.45, df = 639.8, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 2.423978 3.427505
sample estimates:
mean of x mean of y 
 4.330918  1.405176 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>t_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Y=</span><span class="fu">c</span>(Y0,Y1),<span class="at">T=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,N),<span class="fu">rep</span>(<span class="dv">1</span>,N)))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> T,<span class="at">data=</span>t_data)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Y ~ T, data = t_data)

Residuals:
   Min     1Q Median     3Q    Max 
-4.331 -1.839 -0.795  0.423 48.338 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   1.4052     0.1807   7.777 1.84e-14 ***
T             2.9257     0.2555  11.450  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4.04 on 998 degrees of freedom
Multiple R-squared:  0.1161,    Adjusted R-squared:  0.1152 
F-statistic: 131.1 on 1 and 998 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>The linear model and the t-test do not return the true ATE as that was simulated on the log scale. However, if we take the log of the estimate, it is pretty close – log of 2.926 is 1.074. The simulation is not perfect because the ATE will vary across the two parts due to scaling effects, but it will work for our purposes.</p>
<p>As the papers pointed out, the ATE could change if we use nonlinear transformations such as log with an adjustment such as 1 or 0.1 to replace the zeroes. We will test this by fitting two models, one with an outcome of <span class="math inline">\(log(Y+1)\)</span> and the other with <span class="math inline">\(log(Y+0.01)\)</span>. We can then make a table of the model results with the <code>modelsummary</code> package:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>t_data <span class="ot">&lt;-</span> <span class="fu">mutate</span>(t_data,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Y_1=</span>Y <span class="sc">+</span> <span class="dv">1</span>,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Y_01=</span>Y <span class="sc">+</span> <span class="fl">0.01</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>y_mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Y_1) <span class="sc">~</span> T,<span class="at">data=</span>t_data)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>y_mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Y_01) <span class="sc">~</span> T, <span class="at">data=</span>t_data)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(<span class="at">models=</span><span class="fu">list</span>(<span class="st">`</span><span class="at">log(Y + 1)</span><span class="st">`</span><span class="ot">=</span>y_mod1, </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>                         <span class="st">`</span><span class="at">log(Y + 0.01)</span><span class="st">`</span><span class="ot">=</span>y_mod2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
 

  
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tinytable_bmsn8qr24098pqqlr6tc</title>
    <style>
.table td.tinytable_css_lmja749fha8u3wj9hi5t, .table th.tinytable_css_lmja749fha8u3wj9hi5t {    border-bottom: solid 0.1em #d3d8dc; }
.table td.tinytable_css_6tcb2jfillqldhii2ng0, .table th.tinytable_css_6tcb2jfillqldhii2ng0 {    text-align: left; }
.table td.tinytable_css_f4ekrzmimvtyef130o52, .table th.tinytable_css_f4ekrzmimvtyef130o52 {    text-align: center; }
.table td.tinytable_css_wbaoosbgfvrs9parv510, .table th.tinytable_css_wbaoosbgfvrs9parv510 {    text-align: center; }
.table td.tinytable_css_ya5v377c9f93wezmqcuk, .table th.tinytable_css_ya5v377c9f93wezmqcuk {    border-bottom: solid 0.05em black; }
    </style>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script>
  

  
    <div class="container">
      <table class="table table-borderless" id="tinytable_bmsn8qr24098pqqlr6tc" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">log(Y + 1)</th>
                <th scope="col">log(Y + 0.01)</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>(Intercept)</td>
                  <td>0.706   </td>
                  <td>-0.430   </td>
                </tr>
                <tr>
                  <td>           </td>
                  <td>(0.029) </td>
                  <td>(0.067)  </td>
                </tr>
                <tr>
                  <td>T          </td>
                  <td>0.650   </td>
                  <td>1.236    </td>
                </tr>
                <tr>
                  <td>           </td>
                  <td>(0.041) </td>
                  <td>(0.095)  </td>
                </tr>
                <tr>
                  <td>Num.Obs.   </td>
                  <td>1000    </td>
                  <td>1000     </td>
                </tr>
                <tr>
                  <td>R2         </td>
                  <td>0.200   </td>
                  <td>0.146    </td>
                </tr>
                <tr>
                  <td>R2 Adj.    </td>
                  <td>0.200   </td>
                  <td>0.145    </td>
                </tr>
                <tr>
                  <td>AIC        </td>
                  <td>4042.5  </td>
                  <td>4028.7   </td>
                </tr>
                <tr>
                  <td>BIC        </td>
                  <td>4057.2  </td>
                  <td>4043.4   </td>
                </tr>
                <tr>
                  <td>Log.Lik.   </td>
                  <td>-987.324</td>
                  <td>-1822.961</td>
                </tr>
                <tr>
                  <td>F          </td>
                  <td>250.073 </td>
                  <td>169.999  </td>
                </tr>
                <tr>
                  <td>RMSE       </td>
                  <td>0.65    </td>
                  <td>1.50     </td>
                </tr>
        </tbody>
      </table>
    </div>

    <script>
      function styleCell_tinytable_k6chyfbrtqxwrus31w7b(i, j, css_id) {
        var table = document.getElementById("tinytable_bmsn8qr24098pqqlr6tc");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_bmsn8qr24098pqqlr6tc');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_tinytable_k6chyfbrtqxwrus31w7b(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_bmsn8qr24098pqqlr6tc");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }

window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(0, 0, 'tinytable_css_lmja749fha8u3wj9hi5t') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(0, 1, 'tinytable_css_lmja749fha8u3wj9hi5t') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(0, 2, 'tinytable_css_lmja749fha8u3wj9hi5t') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(0, 0, 'tinytable_css_6tcb2jfillqldhii2ng0') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(1, 0, 'tinytable_css_6tcb2jfillqldhii2ng0') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(2, 0, 'tinytable_css_6tcb2jfillqldhii2ng0') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(3, 0, 'tinytable_css_6tcb2jfillqldhii2ng0') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(4, 0, 'tinytable_css_6tcb2jfillqldhii2ng0') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(5, 0, 'tinytable_css_6tcb2jfillqldhii2ng0') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(6, 0, 'tinytable_css_6tcb2jfillqldhii2ng0') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(7, 0, 'tinytable_css_6tcb2jfillqldhii2ng0') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(8, 0, 'tinytable_css_6tcb2jfillqldhii2ng0') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(9, 0, 'tinytable_css_6tcb2jfillqldhii2ng0') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(10, 0, 'tinytable_css_6tcb2jfillqldhii2ng0') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(11, 0, 'tinytable_css_6tcb2jfillqldhii2ng0') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(12, 0, 'tinytable_css_6tcb2jfillqldhii2ng0') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(0, 1, 'tinytable_css_f4ekrzmimvtyef130o52') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(1, 1, 'tinytable_css_f4ekrzmimvtyef130o52') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(2, 1, 'tinytable_css_f4ekrzmimvtyef130o52') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(3, 1, 'tinytable_css_f4ekrzmimvtyef130o52') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(4, 1, 'tinytable_css_f4ekrzmimvtyef130o52') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(5, 1, 'tinytable_css_f4ekrzmimvtyef130o52') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(6, 1, 'tinytable_css_f4ekrzmimvtyef130o52') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(7, 1, 'tinytable_css_f4ekrzmimvtyef130o52') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(8, 1, 'tinytable_css_f4ekrzmimvtyef130o52') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(9, 1, 'tinytable_css_f4ekrzmimvtyef130o52') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(10, 1, 'tinytable_css_f4ekrzmimvtyef130o52') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(11, 1, 'tinytable_css_f4ekrzmimvtyef130o52') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(12, 1, 'tinytable_css_f4ekrzmimvtyef130o52') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(0, 2, 'tinytable_css_wbaoosbgfvrs9parv510') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(1, 2, 'tinytable_css_wbaoosbgfvrs9parv510') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(2, 2, 'tinytable_css_wbaoosbgfvrs9parv510') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(3, 2, 'tinytable_css_wbaoosbgfvrs9parv510') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(4, 2, 'tinytable_css_wbaoosbgfvrs9parv510') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(5, 2, 'tinytable_css_wbaoosbgfvrs9parv510') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(6, 2, 'tinytable_css_wbaoosbgfvrs9parv510') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(7, 2, 'tinytable_css_wbaoosbgfvrs9parv510') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(8, 2, 'tinytable_css_wbaoosbgfvrs9parv510') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(9, 2, 'tinytable_css_wbaoosbgfvrs9parv510') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(10, 2, 'tinytable_css_wbaoosbgfvrs9parv510') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(11, 2, 'tinytable_css_wbaoosbgfvrs9parv510') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(12, 2, 'tinytable_css_wbaoosbgfvrs9parv510') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(4, 0, 'tinytable_css_ya5v377c9f93wezmqcuk') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(4, 1, 'tinytable_css_ya5v377c9f93wezmqcuk') })
window.addEventListener('load', function () { styleCell_tinytable_k6chyfbrtqxwrus31w7b(4, 2, 'tinytable_css_ya5v377c9f93wezmqcuk') })
    </script>

  


</div>
</div>
<p>We can see that the treatment effects are quite different. To get them back on the same scale, we can try a reverse transform (exponential the coefficient):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(y_mod1)[<span class="dv">2</span>]) <span class="sc">-</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        T 
0.9159342 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(y_mod2)[<span class="dv">2</span>]) <span class="sc">-</span> .<span class="dv">01</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       T 
3.433134 </code></pre>
</div>
</div>
<p>We can see that the reverse transform doesn’t improve matters. In either case we end up with a very different coefficient. If we were to interpret the outcome as dollars, such as a salary, then the ATE in the first model would be 0.92 and the ATE in the second would be 3.28. As the papers suggest, changing that constant results in changes in the ATE, and so we need to be careful what constant we choose.</p>
<p>To see if units matters as the papers also propose, we will divide the outcome by 100 and compare to the original outcome while using the same transformation of <span class="math inline">\(log(Y + 1)\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>t_data <span class="ot">&lt;-</span> <span class="fu">mutate</span>(t_data,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Y_1_rescale=</span>(Y<span class="sc">/</span><span class="dv">100</span>)<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>y_mod1_rescale <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Y_1_rescale) <span class="sc">~</span> T,<span class="at">data=</span>t_data)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(<span class="at">models=</span><span class="fu">list</span>(<span class="st">`</span><span class="at">log(Y + 1) Original</span><span class="st">`</span><span class="ot">=</span>y_mod1, </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>                         <span class="st">`</span><span class="at">log(Y + 1) Rescaled</span><span class="st">`</span><span class="ot">=</span>y_mod1_rescale))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
 

  
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tinytable_l0d795q37l9gp233dj1o</title>
    <style>
.table td.tinytable_css_hcmgplj5lgjllx54c5fz, .table th.tinytable_css_hcmgplj5lgjllx54c5fz {    border-bottom: solid 0.1em #d3d8dc; }
.table td.tinytable_css_d408ep2kt3t21jdu8ikz, .table th.tinytable_css_d408ep2kt3t21jdu8ikz {    text-align: left; }
.table td.tinytable_css_5vkta7p0v3y92me9jmbw, .table th.tinytable_css_5vkta7p0v3y92me9jmbw {    text-align: center; }
.table td.tinytable_css_0s1l8o8c1dselxvjy79k, .table th.tinytable_css_0s1l8o8c1dselxvjy79k {    text-align: center; }
.table td.tinytable_css_wyiejb2svnt5px13gz7c, .table th.tinytable_css_wyiejb2svnt5px13gz7c {    border-bottom: solid 0.05em black; }
    </style>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script>
  

  
    <div class="container">
      <table class="table table-borderless" id="tinytable_l0d795q37l9gp233dj1o" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">log(Y + 1) Original</th>
                <th scope="col">log(Y + 1) Rescaled</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>(Intercept)</td>
                  <td>0.706   </td>
                  <td>0.014   </td>
                </tr>
                <tr>
                  <td>           </td>
                  <td>(0.029) </td>
                  <td>(0.002) </td>
                </tr>
                <tr>
                  <td>T          </td>
                  <td>0.650   </td>
                  <td>0.027   </td>
                </tr>
                <tr>
                  <td>           </td>
                  <td>(0.041) </td>
                  <td>(0.002) </td>
                </tr>
                <tr>
                  <td>Num.Obs.   </td>
                  <td>1000    </td>
                  <td>1000    </td>
                </tr>
                <tr>
                  <td>R2         </td>
                  <td>0.200   </td>
                  <td>0.125   </td>
                </tr>
                <tr>
                  <td>R2 Adj.    </td>
                  <td>0.200   </td>
                  <td>0.124   </td>
                </tr>
                <tr>
                  <td>AIC        </td>
                  <td>4042.5  </td>
                  <td>-3735.4 </td>
                </tr>
                <tr>
                  <td>BIC        </td>
                  <td>4057.2  </td>
                  <td>-3720.7 </td>
                </tr>
                <tr>
                  <td>Log.Lik.   </td>
                  <td>-987.324</td>
                  <td>1898.213</td>
                </tr>
                <tr>
                  <td>F          </td>
                  <td>250.073 </td>
                  <td>142.951 </td>
                </tr>
                <tr>
                  <td>RMSE       </td>
                  <td>0.65    </td>
                  <td>0.04    </td>
                </tr>
        </tbody>
      </table>
    </div>

    <script>
      function styleCell_tinytable_rwt2tjb55lrsfdxc91v9(i, j, css_id) {
        var table = document.getElementById("tinytable_l0d795q37l9gp233dj1o");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_l0d795q37l9gp233dj1o');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_tinytable_rwt2tjb55lrsfdxc91v9(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_l0d795q37l9gp233dj1o");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }

window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(0, 0, 'tinytable_css_hcmgplj5lgjllx54c5fz') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(0, 1, 'tinytable_css_hcmgplj5lgjllx54c5fz') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(0, 2, 'tinytable_css_hcmgplj5lgjllx54c5fz') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(0, 0, 'tinytable_css_d408ep2kt3t21jdu8ikz') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(1, 0, 'tinytable_css_d408ep2kt3t21jdu8ikz') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(2, 0, 'tinytable_css_d408ep2kt3t21jdu8ikz') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(3, 0, 'tinytable_css_d408ep2kt3t21jdu8ikz') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(4, 0, 'tinytable_css_d408ep2kt3t21jdu8ikz') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(5, 0, 'tinytable_css_d408ep2kt3t21jdu8ikz') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(6, 0, 'tinytable_css_d408ep2kt3t21jdu8ikz') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(7, 0, 'tinytable_css_d408ep2kt3t21jdu8ikz') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(8, 0, 'tinytable_css_d408ep2kt3t21jdu8ikz') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(9, 0, 'tinytable_css_d408ep2kt3t21jdu8ikz') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(10, 0, 'tinytable_css_d408ep2kt3t21jdu8ikz') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(11, 0, 'tinytable_css_d408ep2kt3t21jdu8ikz') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(12, 0, 'tinytable_css_d408ep2kt3t21jdu8ikz') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(0, 1, 'tinytable_css_5vkta7p0v3y92me9jmbw') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(1, 1, 'tinytable_css_5vkta7p0v3y92me9jmbw') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(2, 1, 'tinytable_css_5vkta7p0v3y92me9jmbw') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(3, 1, 'tinytable_css_5vkta7p0v3y92me9jmbw') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(4, 1, 'tinytable_css_5vkta7p0v3y92me9jmbw') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(5, 1, 'tinytable_css_5vkta7p0v3y92me9jmbw') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(6, 1, 'tinytable_css_5vkta7p0v3y92me9jmbw') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(7, 1, 'tinytable_css_5vkta7p0v3y92me9jmbw') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(8, 1, 'tinytable_css_5vkta7p0v3y92me9jmbw') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(9, 1, 'tinytable_css_5vkta7p0v3y92me9jmbw') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(10, 1, 'tinytable_css_5vkta7p0v3y92me9jmbw') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(11, 1, 'tinytable_css_5vkta7p0v3y92me9jmbw') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(12, 1, 'tinytable_css_5vkta7p0v3y92me9jmbw') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(0, 2, 'tinytable_css_0s1l8o8c1dselxvjy79k') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(1, 2, 'tinytable_css_0s1l8o8c1dselxvjy79k') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(2, 2, 'tinytable_css_0s1l8o8c1dselxvjy79k') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(3, 2, 'tinytable_css_0s1l8o8c1dselxvjy79k') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(4, 2, 'tinytable_css_0s1l8o8c1dselxvjy79k') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(5, 2, 'tinytable_css_0s1l8o8c1dselxvjy79k') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(6, 2, 'tinytable_css_0s1l8o8c1dselxvjy79k') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(7, 2, 'tinytable_css_0s1l8o8c1dselxvjy79k') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(8, 2, 'tinytable_css_0s1l8o8c1dselxvjy79k') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(9, 2, 'tinytable_css_0s1l8o8c1dselxvjy79k') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(10, 2, 'tinytable_css_0s1l8o8c1dselxvjy79k') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(11, 2, 'tinytable_css_0s1l8o8c1dselxvjy79k') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(12, 2, 'tinytable_css_0s1l8o8c1dselxvjy79k') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(4, 0, 'tinytable_css_wyiejb2svnt5px13gz7c') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(4, 1, 'tinytable_css_wyiejb2svnt5px13gz7c') })
window.addEventListener('load', function () { styleCell_tinytable_rwt2tjb55lrsfdxc91v9(4, 2, 'tinytable_css_wyiejb2svnt5px13gz7c') })
    </script>

  


</div>
</div>
<p>Again, we can see that rescaling <span class="math inline">\(Y\)</span> and then applying the <span class="math inline">\(log(Y+1)\)</span> transformation results in a remarkably different ATE. Because dividing by a constant doesn’t affect the proportion of zeroes but does affect the non-zero values, the ATE will consequently change when using this transformation.</p>
</section>
<section id="ordbetareg-to-the-rescue" class="level2">
<h2 class="anchored" data-anchor-id="ordbetareg-to-the-rescue"><code>ordbetareg</code> to the Rescue</h2>
<p>While the authors propose some solutions to this problem, such as using a two-part model, I want to show that the ordered beta regression can estimate scale-free ATEs if the outcome is normalized; that is, rescaled to between 0 and 1. Here we will let 0 be equal to 0 while 1 will be the sum of the outcome, i.e., the total income of the sample. We can rescale so that each observation in our data is equal to the <em>proportion</em> of the total. It corresponds to the following estimand, which I’ll call <span class="math inline">\(ATE_n\)</span> for normalized:</p>
<p><span class="math display">\[
ATE_n = E[\frac{Y1}{Y1+Y0} - \frac{Y0}{Y1+Y0}]
\]</span></p>
<p>Crucially, if we scale the outcome by any value <span class="math inline">\(c\)</span>, <span class="math inline">\(c\)</span> will cancel as it will be in both the top and bottom of the fraction. We could estimate this quantity with either OLS or a t-test, but the error term is likely to be misleading as it won’t respect the bounds of the outcome (i.e.&nbsp;0 or 1). This is where ordered beta regression can help. I’ll estimate two models, one with the original outcome and the second with the original outcome multiplied by a 100 to test for scaling effects. I will specify the <code>true_bounds</code> parameter to be 0 and 1 as by definition there will not be any values at the upper bound of 1.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>t_data <span class="ot">&lt;-</span> <span class="fu">mutate</span>(t_data,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Y_n=</span>Y<span class="sc">/</span>(<span class="fu">sum</span>(Y)),</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Y_n_rescale=</span>(Y<span class="sc">/</span><span class="dv">100</span>)<span class="sc">/</span>(<span class="fu">sum</span>(Y<span class="sc">/</span><span class="dv">100</span>)))</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>y_n_mod <span class="ot">&lt;-</span> <span class="fu">ordbetareg</span>(Y_n <span class="sc">~</span> T,<span class="at">data=</span>t_data,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">chains=</span><span class="dv">1</span>,<span class="at">iter=</span><span class="dv">1000</span>,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">true_bounds=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">refresh=</span><span class="dv">0</span>,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">backend=</span><span class="st">"cmdstanr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 1 chain...

Chain 1 finished in 3.0 seconds.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>y_n_rescale <span class="ot">&lt;-</span> <span class="fu">ordbetareg</span>(Y_n_rescale <span class="sc">~</span> T,<span class="at">data=</span>t_data,</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">chains=</span><span class="dv">1</span>,<span class="at">iter=</span><span class="dv">1000</span>,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">true_bounds=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">refresh=</span><span class="dv">0</span>,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">backend=</span><span class="st">"cmdstanr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 1 chain...

Chain 1 finished in 3.0 seconds.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(<span class="at">models=</span><span class="fu">list</span>(<span class="st">`</span><span class="at">Normalized Y Original</span><span class="st">`</span><span class="ot">=</span>y_n_mod, </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>                         <span class="st">`</span><span class="at">Normalized Y Rescaled</span><span class="st">`</span><span class="ot">=</span>y_n_rescale),</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">statistic=</span><span class="st">"conf.int"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
 

  
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tinytable_uo2jivdxd8o2jm8hepeo</title>
    <style>
.table td.tinytable_css_eqrbjdv1xv0tky3298hj, .table th.tinytable_css_eqrbjdv1xv0tky3298hj {    border-bottom: solid 0.1em #d3d8dc; }
.table td.tinytable_css_2x9dos0xw00t2hf2nt1p, .table th.tinytable_css_2x9dos0xw00t2hf2nt1p {    text-align: left; }
.table td.tinytable_css_rt76km7013e50croaba8, .table th.tinytable_css_rt76km7013e50croaba8 {    text-align: center; }
.table td.tinytable_css_8paaagmyuk11ou0518pm, .table th.tinytable_css_8paaagmyuk11ou0518pm {    text-align: center; }
.table td.tinytable_css_goh4rph5tvv2zqo4dkth, .table th.tinytable_css_goh4rph5tvv2zqo4dkth {    border-bottom: solid 0.05em black; }
    </style>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script>
  

  
    <div class="container">
      <table class="table table-borderless" id="tinytable_uo2jivdxd8o2jm8hepeo" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">Normalized Y Original</th>
                <th scope="col">Normalized Y Rescaled</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>b_Intercept</td>
                  <td>-7.108            </td>
                  <td>-7.114            </td>
                </tr>
                <tr>
                  <td>           </td>
                  <td>[-7.196, -7.011]  </td>
                  <td>[-7.210, -7.012]  </td>
                </tr>
                <tr>
                  <td>b_T        </td>
                  <td>0.608             </td>
                  <td>0.612             </td>
                </tr>
                <tr>
                  <td>           </td>
                  <td>[0.507, 0.707]    </td>
                  <td>[0.515, 0.716]    </td>
                </tr>
                <tr>
                  <td>phi        </td>
                  <td>810.062           </td>
                  <td>808.721           </td>
                </tr>
                <tr>
                  <td>           </td>
                  <td>[732.567, 888.675]</td>
                  <td>[714.157, 890.808]</td>
                </tr>
                <tr>
                  <td>Num.Obs.   </td>
                  <td>1000              </td>
                  <td>1000              </td>
                </tr>
                <tr>
                  <td>R2         </td>
                  <td>0.090             </td>
                  <td>0.091             </td>
                </tr>
                <tr>
                  <td>ELPD       </td>
                  <td>5335.8            </td>
                  <td>5335.9            </td>
                </tr>
                <tr>
                  <td>ELPD s.e.  </td>
                  <td>74.6              </td>
                  <td>74.7              </td>
                </tr>
                <tr>
                  <td>LOOIC      </td>
                  <td>-10671.5          </td>
                  <td>-10671.8          </td>
                </tr>
                <tr>
                  <td>LOOIC s.e. </td>
                  <td>149.3             </td>
                  <td>149.3             </td>
                </tr>
                <tr>
                  <td>WAIC       </td>
                  <td>-10671.6          </td>
                  <td>-10671.9          </td>
                </tr>
                <tr>
                  <td>RMSE       </td>
                  <td>0.00              </td>
                  <td>0.00              </td>
                </tr>
        </tbody>
      </table>
    </div>

    <script>
      function styleCell_tinytable_iu6s6qhsaauvyu51xlxm(i, j, css_id) {
        var table = document.getElementById("tinytable_uo2jivdxd8o2jm8hepeo");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_uo2jivdxd8o2jm8hepeo');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_tinytable_iu6s6qhsaauvyu51xlxm(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_uo2jivdxd8o2jm8hepeo");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }

window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(0, 0, 'tinytable_css_eqrbjdv1xv0tky3298hj') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(0, 1, 'tinytable_css_eqrbjdv1xv0tky3298hj') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(0, 2, 'tinytable_css_eqrbjdv1xv0tky3298hj') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(0, 0, 'tinytable_css_2x9dos0xw00t2hf2nt1p') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(1, 0, 'tinytable_css_2x9dos0xw00t2hf2nt1p') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(2, 0, 'tinytable_css_2x9dos0xw00t2hf2nt1p') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(3, 0, 'tinytable_css_2x9dos0xw00t2hf2nt1p') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(4, 0, 'tinytable_css_2x9dos0xw00t2hf2nt1p') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(5, 0, 'tinytable_css_2x9dos0xw00t2hf2nt1p') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(6, 0, 'tinytable_css_2x9dos0xw00t2hf2nt1p') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(7, 0, 'tinytable_css_2x9dos0xw00t2hf2nt1p') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(8, 0, 'tinytable_css_2x9dos0xw00t2hf2nt1p') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(9, 0, 'tinytable_css_2x9dos0xw00t2hf2nt1p') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(10, 0, 'tinytable_css_2x9dos0xw00t2hf2nt1p') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(11, 0, 'tinytable_css_2x9dos0xw00t2hf2nt1p') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(12, 0, 'tinytable_css_2x9dos0xw00t2hf2nt1p') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(13, 0, 'tinytable_css_2x9dos0xw00t2hf2nt1p') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(14, 0, 'tinytable_css_2x9dos0xw00t2hf2nt1p') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(0, 1, 'tinytable_css_rt76km7013e50croaba8') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(1, 1, 'tinytable_css_rt76km7013e50croaba8') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(2, 1, 'tinytable_css_rt76km7013e50croaba8') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(3, 1, 'tinytable_css_rt76km7013e50croaba8') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(4, 1, 'tinytable_css_rt76km7013e50croaba8') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(5, 1, 'tinytable_css_rt76km7013e50croaba8') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(6, 1, 'tinytable_css_rt76km7013e50croaba8') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(7, 1, 'tinytable_css_rt76km7013e50croaba8') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(8, 1, 'tinytable_css_rt76km7013e50croaba8') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(9, 1, 'tinytable_css_rt76km7013e50croaba8') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(10, 1, 'tinytable_css_rt76km7013e50croaba8') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(11, 1, 'tinytable_css_rt76km7013e50croaba8') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(12, 1, 'tinytable_css_rt76km7013e50croaba8') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(13, 1, 'tinytable_css_rt76km7013e50croaba8') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(14, 1, 'tinytable_css_rt76km7013e50croaba8') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(0, 2, 'tinytable_css_8paaagmyuk11ou0518pm') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(1, 2, 'tinytable_css_8paaagmyuk11ou0518pm') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(2, 2, 'tinytable_css_8paaagmyuk11ou0518pm') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(3, 2, 'tinytable_css_8paaagmyuk11ou0518pm') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(4, 2, 'tinytable_css_8paaagmyuk11ou0518pm') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(5, 2, 'tinytable_css_8paaagmyuk11ou0518pm') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(6, 2, 'tinytable_css_8paaagmyuk11ou0518pm') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(7, 2, 'tinytable_css_8paaagmyuk11ou0518pm') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(8, 2, 'tinytable_css_8paaagmyuk11ou0518pm') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(9, 2, 'tinytable_css_8paaagmyuk11ou0518pm') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(10, 2, 'tinytable_css_8paaagmyuk11ou0518pm') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(11, 2, 'tinytable_css_8paaagmyuk11ou0518pm') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(12, 2, 'tinytable_css_8paaagmyuk11ou0518pm') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(13, 2, 'tinytable_css_8paaagmyuk11ou0518pm') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(14, 2, 'tinytable_css_8paaagmyuk11ou0518pm') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(6, 0, 'tinytable_css_goh4rph5tvv2zqo4dkth') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(6, 1, 'tinytable_css_goh4rph5tvv2zqo4dkth') })
window.addEventListener('load', function () { styleCell_tinytable_iu6s6qhsaauvyu51xlxm(6, 2, 'tinytable_css_goh4rph5tvv2zqo4dkth') })
    </script>

  


</div>
</div>
<p>As can be seen, both estimates are very close. We can convert these treatment effects to marginal effects using the <code>marginaleffects</code> package:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>margin_Y <span class="ot">&lt;-</span> <span class="fu">marginaleffects</span>(y_n_mod, <span class="at">variables=</span><span class="st">"T"</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(margin_Y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Term          Contrast Estimate    2.5 %  97.5 %
    T mean(1) - mean(0) 0.000887 0.000624 0.00196

Columns: term, contrast, estimate, conf.low, conf.high </code></pre>
</div>
</div>
<p>The treatment effect here is miniscule as it represents the proportion of income in the sample accruing to an individual unit. However, we can transform this back to the original scale by simply multiplying the estimated marginal effect for each posterior draw by the sum of Y1 and Y0:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>treatment <span class="ot">&lt;-</span> <span class="fu">posteriordraws</span>(margin_Y) <span class="sc">%&gt;%</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(draw) <span class="sc">%&gt;%</span> </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">T=</span>draw <span class="sc">*</span> <span class="fu">sum</span>(t_data<span class="sc">$</span>Y))</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate a summary/point estimate</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(treatment<span class="sc">$</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.585   2.190   2.542   2.812   3.052   9.119 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot full distribution/uncertainty</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(treatment<span class="sc">$</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/transform-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Doing so gives us a treatment effect of approximately $2.7 dollars on the original scale–or, almost exactly <span class="math inline">\(log 1\)</span> as per our original true ATE. Importantly, the estimated uncertainty of this ATE, which we can visualize by plotting all the posterior draws as a histogram, reflects the skew of the underlying variable, which in this case we would want to capture.</p>
<p>As the package designer Vincent Arel-Bundock pointed out, I can also do the code above using the <code>marginaleffects</code> package directly with the <code>comparisons</code> function:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>treatment2 <span class="ot">&lt;-</span> <span class="fu">avg_comparisons</span>(y_n_mod,</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">variables=</span><span class="st">"T"</span>,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">transform=</span><span class="cf">function</span>(x) x <span class="sc">*</span> <span class="fu">sum</span>(t_data<span class="sc">$</span>Y))</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"The treatment effect estimate is "</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>             <span class="fu">round</span>(treatment2<span class="sc">$</span>estimate,<span class="dv">3</span>),</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>             <span class="st">" with a lower bound of "</span>,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>             <span class="fu">round</span>(treatment2<span class="sc">$</span>conf.low,<span class="dv">3</span>), </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>             <span class="st">" and an upper bound of "</span>,</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>             <span class="fu">round</span>(treatment2<span class="sc">$</span>conf.high,<span class="dv">3</span>),<span class="st">"."</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "The treatment effect estimate is 2.543 with a lower bound of 1.788 and an upper bound of 5.631."</code></pre>
</div>
</div>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>For these reasons, <code>ordbetareg</code> can be used to produce ATEs that are scale-free yet can be still be back-transformed to the original scale by rescaling the marginal effects as produced by the <code>marginaleffects</code> package. If the aim of the analysis is to estimate an ATE that is comparable across samples and income distributions, yet also doesn’t lose its relation to the original data, then <code>ordbetareg</code> can provide readily comparable estimates.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>