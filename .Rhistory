DT::datatable(.)
blogdown::build_site()
blogdown::build_site()
?knitr::kable
install.packages("kableExtra")
require(kableExtra)
blogdown::build_site()
blogdown::build_site()
blogdown::build_site()
blogdown::build_site()
blogdown::build_site()
blogdown::build_site()
blogdown::build_site()
blogdown::build_site()
blogdown::build_site()
blogdown::hugo_build()
blogdown::serve_site()
blogdown::serve_site()
blogdown::stop_server()
blogdown::serve_site()
blogdown::serve_site()
blogdown::serve_site()
knitr::opts_chunk$set(echo = TRUE)
require(dplyr)
require(tidyr)
require(ggplot2)
require(panelsim)
set.seed(662817)
knitr::opts_chunk$set(warning=F,message=F)
gen_data <- tw_data(N=100,
T=2,
case.eff.mean = 1,
cross.eff.mean = -3,
cross.eff.sd = 0,
case.eff.sd = 0,
noise.sd=.25)
gen_data <- tw_data(N=100,
T=2,
case.eff.mean = 1,
cross.eff.mean = -3,
cross.eff.sd = 0,
case.eff.sd = 0,
noise.sd=.25,treat_effect = T)
gen_data <- tw_data(N=100,
T=2,
case.eff.mean = .5,
cross.eff.mean = .3,
cross.eff.sd = 0,
case.eff.sd = 0,
noise.sd=.25,treat_effect = T)
View(gen_data$data)
summary(lm(y~x + factor(time) + factor(case),data=gen_data$data))
summary(lm(y~x + factor(time)*x,data=gen_data$data))
gen_data <- tw_data(N=100,
T=2,
case.eff.mean = .5,
cross.eff.mean = .3,
cross.eff.sd = .05,
case.eff.sd = 0,
noise.sd=.25,treat_effect = T)
summary(lm(y~x + factor(time)*x,data=gen_data$data))
summary(lm(y~x + factor(time) + factor(case),data=gen_data$data))
gen_data <- tw_data(N=100,
T=3,
case.eff.mean = .5,
cross.eff.mean = .3,
cross.eff.sd = 0,
case.eff.sd = 0,
noise.sd=.25,treat_effect = T)
summary(lm(y~x + factor(time) + factor(case),data=gen_data$data))
gen_data <- tw_data(N=100,
T=3,
case.eff.mean = .5,
cross.eff.mean = .3,
cross.eff.sd = 0,
case.eff.sd = 0,
noise.sd=.25,treat_effect = F)
summary(lm(y~x + factor(time) + factor(case),data=gen_data$data))
getAnywhere(tw_data)
gen_data <- tw_data(N=100,
T=3,
case.eff.mean = .5,
cross.eff.mean = .3,
cross.eff.sd = 0,
case.eff.sd = 0,
noise.sd=.25,treat_effect = T,binary_outcome = T)
summary(lm(y~x + factor(time) + factor(case),data=gen_data$data))
summary(lm(y~x + factor(time)*x,data=gen_data$data))
gen_data <- tw_data(N=100,
T=3,
case.eff.mean = .5,
cross.eff.mean = .3,
cross.eff.sd = 0,
case.eff.sd = 0,
noise.sd=.25)
hist(gen_data$data$x)
gen_data$data$x <- as.numeric(gen_data$data$x>median(gen_data$data$x))
summary(lm(y~x + factor(time)*x,data=gen_data$data))
summary(lm(y~x + factor(time) + factor(case),data=gen_data$data))
gen_data <- tw_data(N=100,
T=2,
case.eff.mean = .5,
cross.eff.mean = .3,
cross.eff.sd = .5,
case.eff.sd = 0,
noise.sd=.25)
summary(lm(y~x + factor(time) + factor(case),data=gen_data$data))
gen_data$pars$cross.eff.mean
gen_data$pars$case.eff.mean
getAnywhere(tw_data)
View(gen_data$pars)
View(gen_data$data)
unique(gen_data$data$beta)
unique(gen_data$data$time)
View(gen_data$data$time)
View(gen_data$data)
summary(lm(y~x + factor(time) + x*factor(time),data=gen_data$data))
.37-.85
gen_data <- tw_data(N=100,
T=2,
case.eff.mean = .5,
cross.eff.mean = .3,
cross.eff.sd = 0,
case.eff.sd = 0,
noise.sd=.25)
summary(lm(y~x + factor(time) + factor(case),data=gen_data$data))
summary(lm(y~x + factor(time) + x*factor(time),data=gen_data$data))
knitr::opts_chunk$set(echo = TRUE)
require(dplyr)
require(tidyr)
require(ggplot2)
require(panelsim)
set.seed(662817)
knitr::opts_chunk$set(warning=F,message=F)
knitr::include_graphics("brochure.png")
knitr::include_graphics("detect.png")
knitr::include_graphics("detect.png")
knitr::include_graphics("detect.png")
knitr::include_graphics("downs.png")
journal_data <- readxl::read_xlsx("downs_table.xlsx")
journal_data <- readxl::read_xlsx("downs_table.xlsx")
print("Percentage of fetuses with Down's is: %",round(sum(journal_data$babies_downs)/sum(journal_data$N),3)*100)
sum(journal_data$babies_downs)/sum(journal_data$N)
journal_data <- readxl::read_xlsx("downs_table.xlsx")
print(paste0("Percentage of fetuses with Down's is: %",round(sum(journal_data$babies_downs)/sum(journal_data$N),3)*100))
journal_data <- readxl::read_xlsx("downs_table.xlsx")
print(paste0("Percentage of fetuses with Down's is: ",round(sum(journal_data$babies_downs)/sum(journal_data$N),3)*100),"%")
journal_data <- readxl::read_xlsx("downs_table.xlsx")
print(paste0("Percentage of fetuses with Down's is: ",round(sum(journal_data$babies_downs)/sum(journal_data$N),3)*100,"%"))
age_trends <- readxl::read_xlsx("downs_estimates.xlsx")
View(age_trends)
age_trends <- readxl::read_xlsx("downs_estimates.xlsx") %>% filter(age>13, age<53) %>%
mutate(pred_odds=as.numeric(str_remove(pred_odds,"1:")))
age_trends <- readxl::read_xlsx("downs_estimates.xlsx") %>% filter(age>13, age<53) %>%
mutate(pred_odds=as.numeric(stringr::str_remove(pred_odds,"1:")))
age_trends <- readxl::read_xlsx("downs_estimates.xlsx") %>% filter(age>13, age<53) %>%
mutate(pred_ods=as.numeric(stringr::str_remove(pred_ods,"1:")))
View(age_trends)
age_trends <- readxl::read_xlsx("downs_estimates.xlsx") %>% filter(age>13, age<53) %>%
mutate(pred_ods=as.numeric(stringr::str_remove(pred_ods,"1:")),
pred_ods=1/pred_ods)
View(age_trends)
age_trends <- readxl::read_xlsx("downs_estimates.xlsx") %>% filter(age>13, age<53) %>%
mutate(pred_ods=as.numeric(stringr::str_remove(pred_ods,"1:")),
pred_ods=1/pred_ods,
ppv=(specificity*(1-pred_ods))/((1-sensitivity * pred_ods) + specificity*pred_ods))
sensitivity <- sum(journal_data$babies_downs)/sum(journal_data$N)
specificity <- (sum(journal_data$N) - sum(journal_data$babies_downs))/sum(journal_data$N)
# need Down's syndrome prevalence data by age
# Data taken from: https://journals.sagepub.com/doi/abs/10.1136/jms.9.1.2
# Using predicted values from model vs. observed values
# Morris, Dutton and Alberman (2002)
age_trends <- readxl::read_xlsx("downs_estimates.xlsx") %>% filter(age>13, age<53) %>%
mutate(pred_ods=as.numeric(stringr::str_remove(pred_ods,"1:")),
pred_ods=1/pred_ods,
ppv=(specificity*(1-pred_ods))/((1-sensitivity * pred_ods) + specificity*pred_ods))
View(age_trends)
sensitivity
specificity
journal_data$detection <- as.numeric(stringr::str_extract(journal_data$detection,"[0-9]+"))
journal_data$detection <- as.numeric(stringr::str_extract(journal_data$detection,"[0-9]+"))
sensitivity <- sum(journal_data$detection)/sum(journal_data$babies_downs)
specificity <- (sum(journal_data$N) - sum(journal_data$babies_downs))/sum(journal_data$N)
# need Down's syndrome prevalence data by age
# Data taken from: https://journals.sagepub.com/doi/abs/10.1136/jms.9.1.2
# Using predicted values from model vs. observed values
# Morris, Dutton and Alberman (2002)
age_trends <- readxl::read_xlsx("downs_estimates.xlsx") %>% filter(age>13, age<53) %>%
mutate(pred_ods=as.numeric(stringr::str_remove(pred_ods,"1:")),
pred_ods=1/pred_ods,
ppv=(specificity*(1-pred_ods))/((1-sensitivity * pred_ods) + specificity*pred_ods))
View(age_trends)
sensitivity
specificity
View(journal_data)
journal_data <- readxl::read_xlsx("downs_table.xlsx")
print(paste0("Percentage of fetuses with Down's Syndrome is: ",round(sum(journal_data$babies_downs)/(sum(journal_data$babies_downs + sum(journal_data$N)),3)*100,"%"))
journal_data <- readxl::read_xlsx("downs_table.xlsx")
print(paste0("Percentage of fetuses with Down's Syndrome is: ",round(sum(journal_data$babies_downs)/(sum(journal_data$babies_downs) + sum(journal_data$N)),3)*100,"%"))
journal_data <- mutate(journal_data,detection=as.numeric(stringr::str_extract(detection,"[0-9]+")),
fpr=as.numeric(stringr::str_extract(fpr,"[0-9]+")))
View(journal_data)
sensitivity <- sum(journal_data$babies_downs)/(sum(journal_data$babies_downs) + sum(journal_data$fpr))
sensitivity
specificity <- sum(journal_data$N)/(sum(journal_data$N) + (sum(journal_data$babies_downs) - sum(journal_data$detection)))
specificity
journal_data <- mutate(journal_data,detection=as.numeric(stringr::str_extract(detection,"[0-9]+")),
fpr=as.numeric(stringr::str_extract(fpr,"[0-9]+")))
sensitivity <- sum(journal_data$babies_downs)/(sum(journal_data$babies_downs) + sum(journal_data$fpr))
specificity <- sum(journal_data$N)/(sum(journal_data$N) + (sum(journal_data$babies_downs) - sum(journal_data$detection)))
# need Down's syndrome prevalence data by age
# Data taken from: https://journals.sagepub.com/doi/abs/10.1136/jms.9.1.2
# Using predicted values from model vs. observed values
# Morris, Dutton and Alberman (2002)
age_trends <- readxl::read_xlsx("downs_estimates.xlsx") %>% filter(age>13, age<53) %>%
mutate(pred_ods=as.numeric(stringr::str_remove(pred_ods,"1:")),
pred_ods=1/pred_ods,
ppv=(specificity*(1-pred_ods))/((1-sensitivity * pred_ods) + specificity*pred_ods))
View(age_trends)
100 * (1 - .01) * (1 - .98)
age_trends <- readxl::read_xlsx("downs_estimates.xlsx") %>% filter(age>13, age<53) %>%
mutate(pred_ods=as.numeric(stringr::str_remove(pred_ods,"1:")),
pred_ods=1/pred_ods,
fp=(1 - pred_ods)*(1 - specificity),
ppv=(specificity*(1-pred_ods))/((1-sensitivity * pred_ods) + specificity*pred_ods))
View(age_trends)
specificity
specificity <- sum(journal_data$N)/(sum(journal_data$N) + (sum(journal_data$babies_downs) - sum(journal_data$detection)))
specificity
(sum(journal_data$babies_downs) - sum(journal_data$detection))
sum(journal_data$N)
specificity <- sum(journal_data$N)/(sum(journal_data$N) + sum(journal_data$fpr))
specificity
age_trends <- readxl::read_xlsx("downs_estimates.xlsx") %>% filter(age>13, age<53) %>%
mutate(pred_ods=as.numeric(stringr::str_remove(pred_ods,"1:")),
pred_ods=1/pred_ods,
fp=(1 - pred_ods)*(1 - specificity),
ppv=(specificity*(1-pred_ods))/((1-sensitivity * pred_ods) + specificity*pred_ods))
View(age_trends)
sensitivity <- sum(journal_data$babies_downs)/(sum(journal_data$babies_downs) + (sum(journal_data$babies_downs) - sum(journal_data$detection)))
sensitivity
specificity
sum(journal_data$babies_downs) - sum(journal_data$detection)
age_trends <- readxl::read_xlsx("downs_estimates.xlsx") %>% filter(age>13, age<53) %>%
mutate(pred_ods=as.numeric(stringr::str_remove(pred_ods,"1:")),
pred_ods=1/pred_ods,
fp=(1 - pred_ods)*(1 - specificity),
ppv=pred_ods / (pred_ods + fp))
View(age_trends)
age_trends %>%
ggplot(aes(y=ppv,x=age)) +
geom_line +
scale_y_continuous(labels=scales::percent)
require(ggplot2)
age_trends %>%
ggplot(aes(y=ppv,x=age)) +
geom_line() +
scale_y_continuous(labels=scales::percent)
age_trends %>%
ggplot(aes(y=ppv,x=age)) +
geom_line() +
scale_y_continuous(labels=scales::percent) +
geom_hline(yintercept=0.5,linetype=2)
age_trends %>%
ggplot(aes(y=ppv,x=age)) +
geom_line() +
scale_y_continuous(labels=scales::percent) +
geom_hline(yintercept=0.5,linetype=2) +
theme(panel.background = element_blank()) +
ylab("Chance Fetus Has Downs Syndrom with Positive Test Result") +
xlab("Age of Mother")
age_trends %>%
ggplot(aes(y=ppv,x=age)) +
geom_line() +
scale_y_continuous(labels=scales::percent) +
geom_hline(yintercept=0.5,linetype=2) +
theme(panel.background = element_blank()) +
ylab("Chance of Fetus with Down's Syndrome") +
xlab("Age of Mother")
?knitr::include_graphics
View(age_trends)
age_trends$fp[age_trends$age==27]*1000000
knitr::opts_chunk$set(echo = TRUE)
require(dplyr)
require(tidyr)
require(ggplot2)
require(panelsim)
set.seed(662817)
knitr::opts_chunk$set(warning=F,message=F,fig.align = "center")
select(journal_data,
Study="study",
Method="method",
GA="ga",
`True Positives`="positives",
Detected="detection",
`True Negatives`="negatives",
FPR="fpr") %>%
knitr::kable() %>%
kableExtra::kable_styling()
knitr::opts_chunk$set(echo = TRUE)
require(dplyr)
require(tidyr)
require(ggplot2)
require(panelsim)
set.seed(662817)
knitr::opts_chunk$set(warning=F,message=F,fig.align = "center")
knitr::include_graphics("brochure.png")
knitr::include_graphics("detect.png")
knitr::include_graphics("downs.png")
journal_data <- readxl::read_xlsx("downs_table.xlsx")
print(paste0("Percentage of fetuses with Down's Syndrome is: ",round(sum(journal_data$positives)/(sum(journal_data$positives) + sum(journal_data$N)),3)*100,"%"))
journal_data <- mutate(journal_data,detection=as.numeric(stringr::str_extract(detection,"[0-9]+")),
fpr=as.numeric(stringr::str_extract(fpr,"[0-9]+")))
sensitivity <- sum(journal_data$positives)/(sum(journal_data$positives) + (sum(journal_data$positives) - sum(journal_data$detection)))
specificity <- sum(journal_data$N)/(sum(journal_data$N) + sum(journal_data$fpr))
# need Down's syndrome prevalence data by age
# Data taken from: https://journals.sagepub.com/doi/abs/10.1136/jms.9.1.2
# Using predicted values from model vs. observed values
# Morris, Dutton and Alberman (2002)
age_trends <- readxl::read_xlsx("downs_estimates.xlsx") %>% filter(age>13, age<53) %>%
mutate(pred_ods=as.numeric(stringr::str_remove(pred_ods,"1:")),
# convert odds to percentages
pred_ods=1/pred_ods,
# false positive rate
fp=(1 - pred_ods)*(1 - specificity),
ppv=pred_ods / (pred_ods + fp))
age_trends %>%
ggplot(aes(y=ppv,x=age)) +
geom_line() +
scale_y_continuous(labels=scales::percent) +
geom_hline(yintercept=0.5,linetype=2) +
theme(panel.background = element_blank()) +
ylab("Chance of Fetus with Down's Syndrome") +
xlab("Age of Mother")
select(journal_data,
Study="study",
Method="method",
GA="ga",
`True Positives`="positives",
Detected="detection",
`True Negatives`="negatives",
FPR="fpr") %>%
knitr::kable() %>%
kableExtra::kable_styling()
View(journal_data)
knitr::opts_chunk$set(echo = TRUE)
require(dplyr)
require(tidyr)
require(ggplot2)
require(panelsim)
set.seed(662817)
knitr::opts_chunk$set(warning=F,message=F,fig.align = "center")
knitr::include_graphics("brochure.png")
knitr::include_graphics("detect.png")
knitr::include_graphics("downs.png")
journal_data <- readxl::read_xlsx("downs_table.xlsx")
print(paste0("Percentage of fetuses with Down's Syndrome is: ",round(sum(journal_data$positives)/(sum(journal_data$positives) + sum(journal_data$negatives)),3)*100,"%"))
journal_data <- mutate(journal_data,detection=as.numeric(stringr::str_extract(detection,"[0-9]+")),
fpr=as.numeric(stringr::str_extract(fpr,"[0-9]+")))
sensitivity <- sum(journal_data$positives)/(sum(journal_data$positives) + (sum(journal_data$positives) - sum(journal_data$detection)))
specificity <- sum(journal_data$negatives)/(sum(journal_data$negativesegatives) + sum(journal_data$fpr))
# need Down's syndrome prevalence data by age
# Data taken from: https://journals.sagepub.com/doi/abs/10.1136/jms.9.1.2
# Using predicted values from model vs. observed values
# Morris, Dutton and Alberman (2002)
age_trends <- readxl::read_xlsx("downs_estimates.xlsx") %>% filter(age>13, age<53) %>%
mutate(pred_ods=as.numeric(stringr::str_remove(pred_ods,"1:")),
# convert odds to percentages
pred_ods=1/pred_ods,
# false positive rate
fp=(1 - pred_ods)*(1 - specificity),
ppv=pred_ods / (pred_ods + fp))
age_trends %>%
ggplot(aes(y=ppv,x=age)) +
geom_line() +
scale_y_continuous(labels=scales::percent) +
geom_hline(yintercept=0.5,linetype=2) +
theme(panel.background = element_blank()) +
ylab("Chance of Fetus with Down's Syndrome") +
xlab("Age of Mother")
select(journal_data,
Study="study",
Method="method",
GA="ga",
`True Positives`="positives",
Detected="detection",
`True Negatives`="negatives",
FPR="fpr") %>%
knitr::kable() %>%
kableExtra::kable_styling()
knitr::opts_chunk$set(echo = TRUE)
require(dplyr)
require(tidyr)
require(ggplot2)
require(panelsim)
set.seed(662817)
knitr::opts_chunk$set(warning=F,message=F,fig.align = "center")
knitr::include_graphics("brochure.png")
knitr::include_graphics("detect.png")
knitr::include_graphics("downs.png")
journal_data <- readxl::read_xlsx("downs_table.xlsx")
print(paste0("Percentage of fetuses with Down's Syndrome is: ",round(sum(journal_data$positives)/(sum(journal_data$positives) + sum(journal_data$negatives)),3)*100,"%"))
journal_data <- mutate(journal_data,detection=as.numeric(stringr::str_extract(detection,"[0-9]+")),
fpr=as.numeric(stringr::str_extract(fpr,"[0-9]+")))
sensitivity <- sum(journal_data$positives)/(sum(journal_data$positives) + (sum(journal_data$positives) - sum(journal_data$detection)))
specificity <- sum(journal_data$negatives)/(sum(journal_data$negatives) + sum(journal_data$fpr))
# need Down's syndrome prevalence data by age
# Data taken from: https://journals.sagepub.com/doi/abs/10.1136/jms.9.1.2
# Using predicted values from model vs. observed values
# Morris, Dutton and Alberman (2002)
age_trends <- readxl::read_xlsx("downs_estimates.xlsx") %>% filter(age>13, age<53) %>%
mutate(pred_ods=as.numeric(stringr::str_remove(pred_ods,"1:")),
# convert odds to percentages
pred_ods=1/pred_ods,
# false positive rate
fp=(1 - pred_ods)*(1 - specificity),
ppv=pred_ods / (pred_ods + fp))
age_trends %>%
ggplot(aes(y=ppv,x=age)) +
geom_line() +
scale_y_continuous(labels=scales::percent) +
geom_hline(yintercept=0.5,linetype=2) +
theme(panel.background = element_blank()) +
ylab("Chance of Fetus with Down's Syndrome") +
xlab("Age of Mother")
select(journal_data,
Study="study",
Method="method",
GA="ga",
`True Positives`="positives",
Detected="detection",
`True Negatives`="negatives",
FPR="fpr") %>%
knitr::kable() %>%
kableExtra::kable_styling()
age_trends %>%
ggplot(aes(y=ppv,x=age)) +
geom_line() +
scale_y_continuous(labels=scales::percent) +
geom_hline(yintercept=0.5,linetype=2) +
geom_hline(yintercept=0.975,linetype=3,colour="red") +
theme(panel.background = element_blank()) +
ylab("Chance of Fetus with Down's Syndrome") +
xlab("Age of Mother")
age_trends %>%
ggplot(aes(y=ppv,x=age)) +
geom_line() +
scale_y_continuous(labels=scales::percent) +
geom_hline(yintercept=0.5,linetype=2) +
geom_hline(yintercept=0.975,linetype=3,colour="red") +
theme(panel.background = element_blank()) +
ylab("Chance of Fetus with Down's Syndrome") +
xlab("Age of Mother") +
annotate("text",x=c(20,20),y=c(52,95),label=c("50%","LabCorp Brochure: 97.5%"))
age_trends %>%
ggplot(aes(y=ppv,x=age)) +
geom_line() +
scale_y_continuous(labels=scales::percent) +
geom_hline(yintercept=0.5,linetype=2) +
geom_hline(yintercept=0.975,linetype=3,colour="red") +
theme(panel.background = element_blank()) +
ylab("Chance of Fetus with Down's Syndrome") +
xlab("Age of Mother") +
annotate("text",x=c(20,20),y=c(.52,.95),label=c("50%","LabCorp Brochure: 97.5%"))
age_trends %>%
ggplot(aes(y=ppv,x=age)) +
geom_line() +
scale_y_continuous(labels=scales::percent) +
geom_hline(yintercept=0.5,linetype=2) +
geom_hline(yintercept=0.975,linetype=3,colour="red") +
theme(panel.background = element_blank()) +
ylab("Chance of Fetus with Down's Syndrome") +
xlab("Age of Mother") +
annotate("text",x=c(20,20),y=c(.52,.96),label=c("50%","LabCorp Brochure: 97.5%"))
age_trends %>%
ggplot(aes(y=ppv,x=age)) +
geom_line() +
scale_y_continuous(labels=scales::percent) +
geom_hline(yintercept=0.5,linetype=2) +
geom_hline(yintercept=0.975,linetype=3,colour="red") +
theme(panel.background = element_blank()) +
ylab("Chance of Fetus with Down's Syndrome") +
xlab("Age of Mother") +
annotate("text",x=c(20,20),y=c(.52,.98),label=c("50%","LabCorp Brochure: 97.5%"))
age_trends %>%
ggplot(aes(y=ppv,x=age)) +
geom_line() +
scale_y_continuous(labels=scales::percent) +
geom_hline(yintercept=0.5,linetype=2) +
geom_hline(yintercept=0.975,linetype=3,colour="red") +
theme(panel.background = element_blank()) +
ylab("Chance of Fetus with Down's Syndrome") +
xlab("Age of Mother") +
annotate("text",x=c(20,20),y=c(.52,.99),label=c("50%","LabCorp Brochure: 97.5%"))
age_trends %>%
ggplot(aes(y=ppv,x=age)) +
geom_line() +
scale_y_continuous(labels=scales::percent) +
geom_hline(yintercept=0.5,linetype=2) +
geom_hline(yintercept=0.975,linetype=3,colour="red") +
theme(panel.background = element_blank()) +
ylab("Chance of Fetus with Down's Syndrome") +
xlab("Age of Mother") +
annotate("text",x=c(20,42),y=c(.52,.99),label=c("50%","LabCorp Brochure: 97.5%"))
blogdown::build_site()
blogdown::build_site()
remotes::install_github("saudiwin/panelsim")
blogdown::build_site()
blogdown::build_site()
blogdown::build_site()
check <- readRDS("content/post/data/pan_model_est.rds")
print(check,"suppress_effect")
